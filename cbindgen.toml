# cbindgen configuration for moca C FFI

language = "C"
include_guard = "MOCA_H"
autogen_warning = "/* Warning: This file is auto-generated by cbindgen. Do not modify manually. */"

# Use C, not C++
cpp_compat = false

# Include documentation comments
documentation = true
documentation_style = "doxy"

# Output settings
line_length = 100
tab_width = 4
style = "type"

# Header settings
header = """
/**
 * @file moca.h
 * @brief Moca VM C API for embedding
 * @version 0.1.0
 *
 * This is the C API for embedding the moca VM in host applications.
 *
 * Basic usage:
 * @code
 * moca_vm *vm = moca_vm_new();
 * if (!vm) {
 *     // Handle allocation failure
 * }
 *
 * // Load bytecode
 * moca_result res = moca_load_chunk(vm, bytecode_data, bytecode_len);
 * if (res != MOCA_OK) {
 *     printf("Load error: %s\\n", moca_get_error(vm));
 *     moca_vm_free(vm);
 *     return 1;
 * }
 *
 * // Call a function
 * moca_push_i64(vm, 42);  // Push argument
 * res = moca_call(vm, "my_function", 1);  // Call with 1 argument
 * if (res == MOCA_OK) {
 *     int64_t result = moca_to_i64(vm, -1);  // Get return value
 *     moca_pop(vm, 1);  // Pop return value
 * }
 *
 * moca_vm_free(vm);
 * @endcode
 */
"""

# Prefix for enum variants
[enum]
prefix_with_name = true
rename_variants = "ScreamingSnakeCase"

# Parse settings
[parse]
parse_deps = false

# Only export the FFI module types and exclude everything else
[export]
include = [
    "MocaResult",
    "MocaVm",
]
item_types = ["enums", "structs", "typedefs", "functions", "constants"]
# Exclude internal types
exclude = [
    "VmWrapper",
    "HostFunction",
    "Reg",
    "Value",
    "VM",
    "Chunk",
    "JitMode",
    "GcMode",
    "RuntimeConfig",
    "DumpOptions",
    "Opcode",
    "Instruction",
    "RefBitset",
    "StackMapEntry",
    "StackMap",
]

# Function settings
[fn]
prefix = ""
postfix = ""
args = "vertical"
